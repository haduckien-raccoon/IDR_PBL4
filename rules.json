[
  {
    "uuid": "SQLI_C-TAUTOLOGY-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\b(?:AND|OR)\\b|['\"`\\u2019])(?:[\\s+]{1,20}|/\\*.*?\\*/|%20|%2b){1,20}(?:'?\"?1'?\"?\\s*[=<>]{1,2}\\s*'?\"?1|'?\"?\\w{1,5}'?\"?\\s*[=<>]{1,2}\\s*'?\"?\\w{1,5}|\\bTRUE\\b)",
    "message": "[SQLi-C] SQL Tautology detected (e.g., 1=1, 'x='x', OR TRUE)",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-UNION-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bUNION\\b(?:[\\s+]{1,20}|/\\*.*?\\*/|%20|%2b){1,20}(?:ALL(?:[\\s+]{1,20}|/\\*.*?\\*/|%20|%2b){1,20})?\\bSELECT\\b",
    "message": "[SQLi-C] UNION SELECT pattern detected",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-TIMEBASED-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:SLEEP|PG_SLEEP|WAITFOR\\s+DELAY|BENCHMARK)\\b\\s*\\([\\s\\S]{1,100}\\)",
    "message": "[SQLi-C] Time-based SQLi function detected (SLEEP, WAITFOR, BENCHMARK)",
    "severity": "critical",
    "action": "block"
  },
  {
    "uuid": "SQLI_C-CMDEXEC-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:xp_cmdshell|sp_executesql|sp_addlogin|sp_addsrvrolemember|xp_reg)\\b",
    "message": "[SQLi-C] Dangerous Stored Procedure execution (xp_cmdshell, sp_...)",
    "severity": "critical",
    "action": "block"
  },
  {
    "uuid": "SQLI_C-FILEOPS-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:LOAD_FILE|LOAD\\s+DATA|INTO\\s+(?:OUTFILE|DUMPFILE)|BULK\\s+INSERT|COPY\\b[\\s\\S]{1,50}?\\bFROM|BACKUP\\s+DATABASE[\\s\\S]{1,50}?\\bTO\\b)",
    "message": "[SQLi-C] File Access/Exfiltration attempt (LOAD_FILE, OUTFILE, BULK INSERT, COPY)",
    "severity": "critical",
    "action": "block"
  },
  {
    "uuid": "SQLI_C-INFO-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:@@version|information_schema|pg_shadow|pg_group|pg_user|V\\$|master\\.\\.|sys\\.|CURRENT_SETTING|GLOBAL_NAME)\\b",
    "message": "[SQLi-C] Information Disclosure (@@version, information_schema, pg_shadow, V$)",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-OBFUSCATION-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\bCHAR\\s*\\(\\s*0x[0-9A-Fa-f]{1,}|0x[0-9A-Fa-f]{4,})(?:\\s*\\+|\\s*\\||\\s*,\\s*)",
    "message": "[SQLi-C] Obfuscation attempt (CHAR(0x...) or long hex string concatenation)",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-DDL-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:DROP\\s+(?:TABLE|DATABASE)|CREATE\\s+(?:USER|ROLE)|ALTER\\s+USER|GRANT\\b\\s+(?:CONNECT|RESOURCE|DBA))\\b",
    "message": "[SQLi-C] Destructive DDL or Privilege Escalation (DROP, CREATE USER, GRANT)",
    "severity": "critical",
    "action": "block"
  },
  {
    "uuid": "SQLI_C-AUTH_BYPASS-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bADMIN\\b\\s*(?:['\\\"]|%27)?\\s*(?:\\bOR\\b|%4f%52)[\\s\\S]{1,50}(?:1=1|'\\w'='\\w)",
    "message": "[SQLi-C] Auth Bypass (admin OR 1=1)",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-ENUM-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:ORDER|GROUP)\\s+BY\\b(?:[\\s\\S]{1,100}?\\b(?:SLEEP|BENCHMARK)\\b|[\\s+]*\\d{1,3}(?:[\\s,]*\\d{1,3})*\\s*(?:--|#|/\\*|$))",
    "message": "[SQLi-C] Enumeration or Time-based in ORDER/GROUP BY",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-SUBSELECT-001",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)[=><]\\s*\\(\\s*\\bSELECT\\b|\\bRLIKE\\s*\\(\\s*\\bSELECT\\b|\\bIF\\s*\\(\\s*\\bSELECT\\b",
    "message": "[SQLi-C] Boolean-based using sub-select (e.g., ...=(SELECT...), RLIKE(SELECT...))",
    "severity": "high",
    "action": "alert"
  },
  {
    "uuid": "SQLI_C-COMMENT-001-balanced",
    "group_id": "SQLI_CONSOLIDATED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:--|#|/\\*!\\d|%2D%2D|%23)\\s*(?:\\b(?:SELECT|UNION|DROP|EXEC|INSERT|UPDATE|DELETE)\\b)[\\s\\S]{0,30}(?:\\bFROM\\b|;|'|\")",
    "message": "[SQLi-C] Suspicious SQL comment (balanced)",
    "severity": "medium",
    "action": "alert"
  },
  {
    "uuid": "http-dothtaccess-encoded-cmd-002",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT|HEAD|DELETE)\\s+[^\\s]*?(?:\\.|%2[eE])htaccess(?:\\?[^\\r\\n]*\\bcmd\\b\\s*=\\s*[^\\s&]+)?\\s+HTTP/\\d\\.\\d",
    "use_aho": false,
    "message": "Possible remote command attempt via encoded .htaccess (cmd param) — HTTP request-line matched",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },

  {
    "uuid": "fa012328-8a1b-11ef-9cba-0242ac120002",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT)\\s+[^\\r\\n]*(?:\\b(?:password|passwd|pwd|pass)\\b\\s*=\\s*[^\\s&]+)",
    "use_aho": false,
    "message": "Possible credential leakage in HTTP request (param name matched in request-line or form body)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },

  {
    "uuid": "aa123456-8a1b-11ef-9cba-0242ac120002",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT)\\s+[^\\r\\n]*?(?:[?&][^=\\s&]*=([^\\r\\n]*))(?:;\\s*(?:ls|cat|whoami|nc|bash)\\b|`[^`]+`|\\b(?:\\|\\||&&)\\s*(?:ls|whoami|id)\\b)",
    "use_aho": false,
    "message": "Suspicious command-injection-like characters in HTTP parameter value",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },

  {
    "uuid": "bb234567-8a1b-11ef-9cba-0242ac120002",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT)\\s+[^\\r\\n]*(?:[?&][^=\\s&]*=([^\\r\\n]*))\\b(?:<script\\b|javascript:|onerror\\s*=|onload\\s*=)",
    "use_aho": false,
    "message": "Possible reflected/stored XSS attempt via HTTP parameter",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f2a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_TRAVERSAL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)^(?:GET|POST|PUT|HEAD)\\s+\\S*(?:\\.{2,}/|%2e%2e%2f){2,}\\S*\\s+HTTP/\\d\\.\\d|[?&][^=]+=([^&]*(?:\\.{2,}/|%2e%2e%2f){2,}[^&]*)",
    "use_aho": false,
    "message": "Directory traversal attempt detected in URI or query param (2+ ../ or encoded ../ sequences)",
    "severity": "high",
    "action": "alert",
    "notes": "Check only request-line and query params; avoid body and headers."
  },
  {
    "uuid": "f3a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_NULLBYTE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT|HEAD)\\s+\\S*(?:%00|%2500)\\b\\s+HTTP/\\d\\.\\d|[?&][^=]+=([^&]*(?:%00|%2500)\\b)",
    "use_aho": false,
    "message": "Null byte encoded in URI or query param — possible LFI/null-byte poisoning",
    "severity": "high",
    "action": "alert",
    "notes": "Only URI/request-line and query params; do not match body."
  },
  {
    "uuid": "f6a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_ENCODING_EVASION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:[?&][^=]+=[^&]*?(?:%c0%af|%c1%1c|%c1%9c|%ef%bc%8f|%252f|%2f)[^&]*)|^(?:GET|POST)\\s+\\S*?(?:%c0%af|%ef%bc%8f|%252f)\\S*\\s+HTTP/\\d\\.\\d",
    "use_aho": false,
    "message": "Encoded or double-encoded slash/overlong sequences detected in URI or query param — possible LFI evasion",
    "severity": "high",
    "action": "alert",
    "notes": "Restrict to URI/query param context; avoid matching arbitrary body text."
  },
  {
    "uuid": "f5a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_HTTPD_LOGS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:GET|POST|PUT)\\s+\\S*\\b(?:httpd\\.conf|httpd2\\.conf|access_log|error_log|http\\-access\\.log|http\\-error\\.log|apache2[\\\\/].*httpd\\.conf)\\b\\S*\\s+HTTP/\\d\\.\\d|[?&][^=]+=([^&]*\\b(?:httpd\\.conf|access_log|error_log)\\b[^&]*)",
    "use_aho": false,
    "message": "Probe for webserver config/log files in URI or query param",
    "severity": "high",
    "action": "alert",
    "notes": "Check only URI/request-line and query params; changed from block to alert."
  },
  {
    "uuid": "lfi_media_001",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:POST)\\s+\\S+\\s+HTTP/\\d\\.\\d[\\s\\S]*Content-Type:\\s*multipart/form-data;.*\\b[Rr][Ii][Ff][Ff].*AVI",
    "use_aho": false,
    "message": "Possible malicious media upload containing RIFF/AVI signature",
    "severity": "high",
    "action": "alert",
    "notes": "Only inspect multipart file uploads."
  },
  {
    "uuid": "lfi_media_002",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)^(?:POST)\\s+\\S+\\s+HTTP/\\d\\.\\d[\\s\\S]*Content-Type:\\s*multipart/form-data;[\\s\\S]*(?:<\\?php|<script|<iframe|onerror=|onload=|eval\\(|system\\(|exec\\(|base64_decode\\()",
    "use_aho": false,
    "message": "Uploaded file contains embedded script/PHP patterns — only check multipart uploads",
    "severity": "critical",
    "action": "block",
    "notes": "Block only when pattern appears inside multipart file parts."
  },
  {
    "uuid": "b871c676-8949-4d25-b665-2cde15fd02e2",
    "group_id": "CMD-INJ-001",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:[?&][^=]+=([^&]*;\\s*(?:ls|cat|whoami|id|nc|bash)\\b))",
    "use_aho": false,
    "message": "Potential command injection in query param value (semicolon + shell keyword)",
    "severity": "medium",
    "action": "alert",
    "notes": "Require semicolon + known command token; only match param values."
  },
  {
    "uuid": "69ce2f3e-15c4-4e95-ae5f-f04da634819a",
    "group_id": "CMD-INJ-002",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(?:[?&](cmd|action|exec)=[^&]*(?:;|`|\\|\\||&&)\\s*(?:whoami|ls|cat|wget|curl)\\b)",
    "use_aho": false,
    "message": "Command injection attempt detected in selected parameter values (cmd/action/exec) — param context",
    "severity": "medium",
    "action": "alert",
    "notes": "Only trigger on suspicious param names with command separators; reduces false positives."
  },
  {
    "uuid": "5f39cffb-2347-4b0f-a868-547a496d8e44",
    "group_id": "CMD-INJ-003",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:cmd=[^&]*;|`[^`]+`|\\|\\||&&)",
    "use_aho": false,
    "message": "Command-like constructs found in cmd= parameter (query or POST param) — log only",
    "severity": "low",
    "action": "log",
    "notes": "Only trigger on explicit param `cmd` to reduce false positives."
  },
  {
    "uuid": "htshell-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.htaccess",
    "use_aho": false,
    "message": "Suspicious .htaccess mapping to PHP detected",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-002",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?php.*?>",
    "use_aho": false,
    "message": "PHP code detected inside uploaded file",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-003",
    "group_id": "SERVER_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)SetHandler\\s+server-(status|info)",
    "use_aho": false,
    "message": "Attempt to enable server-status/server-info via .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+/.htaccess\\b.*",
    "use_aho": false,
    "message": "Direct access attempt to .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-addtype-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.rce",
    "use_aho": false,
    "message": "Detected AddType mapping .rce to PHP (possible .htaccess web-shell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-upload-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\.(rce)\\b",
    "use_aho": false,
    "message": "Uploaded file with .rce extension detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-phpcode-003",
    "group_id": "UPLOAD_PHP_TAG",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)",
    "use_aho": false,
    "message": "Uploaded content contains PHP tags",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-access-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+\\S+\\.rce\\b",
    "use_aho": false,
    "message": "Direct access attempt to .rce file",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-dothtaccess-cmd-001",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+[^\\s]*\\.htaccess\\?[^\\n\\r]*\\bcmd\\s*=\\s*[^\\s&]+",
    "use_aho": false,
    "message": "Remote command injection attempt via .htaccess (cmd parameter)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-sqli-union-001",
    "group_id": "WEB-SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\bUNION\\b\\s+\\bSELECT\\b|\\bSELECT\\b[^\\n\\r]{0,120}\\bFROM\\b[^\\n\\r]{0,120}\\bUNION\\b)",
    "use_aho": false,
    "message": "Possible SQL injection: UNION SELECT pattern detected in HTTP request",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-sqli-boolean-or-001",
    "group_id": "WEB-SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\b'or\\b|\\b\\\"or\\b)\\s+[^\\s]*=\\s*[^\\s]+|(?:--\\s*$|#\\s*$|/\\*.*\\*/)",
    "use_aho": false,
    "message": "Possible SQL injection: boolean OR / comment-based injection",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.htaccess|AddType\\s+application/x-httpd-php\\s*\\.rce",
    "use_aho": false,
    "message": "Suspicious AddType mapping .htaccess/.rce to PHP detected",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-002",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)",
    "use_aho": false,
    "message": "PHP code detected in uploaded content",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-003",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Require\\s+all\\s+granted|Order\\s+allow,deny|Allow\\s+from\\s+all",
    "use_aho": false,
    "message": "Directive making .htaccess accessible detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+/.htaccess\\b.*",
    "use_aho": false,
    "message": "Direct access attempt to .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-005",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+\\S+\\.rce\\b",
    "use_aho": false,
    "message": "Direct access attempt to .rce file",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[\\\"']?([^\\r\\n\\\"']*(?:\\.zip|\\.ZIP))[^\\r\\n\\\"']*[\\\"']?.*|(\\%2e\\%2e|\\.\\.)",
    "use_aho": false,
    "message": "Uploaded zip filename contains path traversal or encoded ../",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?s)(?:PK\\\\x03\\\\x04).*?(?:\\.\\./|%2e%2e|/\\\\\\.\\\\.)",
    "use_aho": false,
    "message": "ZIP archive contains path traversal entries (PK header + ../ or encoded variants)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)PK\\\\x03\\\\x04.*?\\.\\./[^\\r\\n]*__init__\\.py",
    "use_aho": false,
    "message": "ZIP contains ../.../__init__.py entry — possible python package trojanization",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-004",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)PK\\\\x03\\\\x04.*?/([A-Za-z0-9_\\-]+/)*[A-Za-z0-9_\\-]+",
    "use_aho": false,
    "message": "ZIP archive contains absolute path entries (leading slash) — suspicious",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-upload-005",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[^\\r\\n]*\\.(py|php|phtml|htaccess)\\b",
    "use_aho": false,
    "message": "Upload attempt contains potentially executable/config files (.py, .php, .htaccess)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-path-enc-006",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)%2e%2e%2f|%2e%2e%5c",
    "use_aho": false,
    "message": "URL-encoded traversal sequence detected in request",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "uwsgi-exec-001",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*exec://",
    "message": "uWSGI config executes system command (exec://)",
    "severity": "critical",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-http-002",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*http://",
    "message": "uWSGI config loads remote content (http://)",
    "severity": "high",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-fd-003",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*fd://",
    "message": "uWSGI config reads from file descriptor (fd://)",
    "severity": "medium",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-call-004",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*call://",
    "message": "uWSGI config calls internal C function (call://)",
    "severity": "high",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "upload-xss-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\s*script\\b[^>]*>|javascript:\\s*|onerror\\s*=|onload\\s*=",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-xss-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Type:\\s*(text/html|application/javascript)",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-xss-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)%3Cscript%3E|%3Ciframe|%3Cimg%20onerror",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[^\\r\\n]*\\.(php|phtml|php[3-8]|phar)\\b",
    "use_aho": false,
    "message": "Attempt to upload PHP executable file (possible webshell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)|eval\\s*\\(|system\\s*\\(|shell_exec\\s*\\(|exec\\s*\\(",
    "use_aho": false,
    "message": "Possible PHP webshell code in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<Files|AddType\\s+application/x-httpd-php|php_flag|php_value",
    "use_aho": false,
    "message": "Possible malicious .htaccess upload to enable PHP execution",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-004",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)filename\\s*=\\s*[^\\r\\n]*\\.(?:php\\d*|pht|phar|phpt|pgif|phtml|phtm|inc|jpe?g\\.php|png\\.php|php(?:%00|\\\\x00)?\\.(?:jpg|png|gif))\\b",
    "use_aho": false,
    "message": "Attempt to upload PHP-related or disguised PHP file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-005",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)|eval\\s*\\(|system\\s*\\(|exec\\s*\\(|shell_exec\\s*\\(",
    "use_aho": false,
    "message": "Possible PHP webshell payload inside uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "detect-jpeg-php-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\xFF\\xDA[\\s\\S]{0,20000}\\<\\?php|\\<\\?\\s",
    "use_aho": false,
    "message": "JPEG contains embedded PHP tag between SOS and EOI (possible disguised webshell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-filename-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)filename\\s*=\\s*[^\\r\\n]*\\.(?:php|phtml|php\\d+|php%00|php\\\\x00|jpg\\.php|jpeg\\.php|png\\.php)\\b",
    "use_aho": false,
    "message": "Upload filename indicates disguised PHP (double extension / null byte)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  
  {
    "uuid": "ssi-exec-shell-commands",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!--\\s*#exec\\b[^>]*?cmd\\s*=\\s*(?:\"|')?[^\\\"'>]*?(?:/bin/cat|/etc/passwd|/etc/shadow|/usr/bin/id|/bin/ls|/usr/bin/netstat|/usr/bin/id;)[^\\\"'>]*?(?:\"|')?[^>]*?-->",
    "use_aho": false,
    "message": "SSI #exec payload attempting to run shell commands (cat /etc/passwd, id, ls, netstat, ...)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "inline-shell-separators-pipes-backticks",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[;\\|&]\\s*(?:/usr/bin/id|/bin/ls|/bin/cat|netstat|id|ls)\\b|`[^`]{0,300}\\b(?:/usr/bin/id|/bin/ls|/bin/cat|id)\\b[^`]{0,300}`|\\b(?:/usr/bin/id|/bin/ls|/bin/cat)\\b\\s*;)",
    "use_aho": false,
    "message": "Inline shell separators, pipes or backticks with common command names (id, ls, cat, netstat)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "system-popen-exec-php-constructs",
    "group_id": "CODE_INJECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\b(?:system|exec|popen|passthru|shell_exec)\\s*\\(\\s*['\\\"][^'\\\"]*(?:cat\\s+/etc/passwd|/usr/bin/id|id|/bin/ls|netstat|ping)[^'\\\"]*['\\\"]\\s*\\)",
    "use_aho": false,
    "message": "Use of runtime execution functions (system/exec/popen/...) with suspicious command strings",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "encoded-newline-and-percent-encoding-commands",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)(?:%0a|%0A|\\n)\\s*(?:cat%20/etc/passwd|/usr/bin/id|id|/bin/ls|/usr/bin/id|ping\\b|netstat\\b)",
    "use_aho": false,
    "message": "Percent-encoded or literal newline followed by suspicious command (cat /etc/passwd, id, ls, ping, netstat)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "suspicious-ping-netstat-longrun",
    "group_id": "DOS_AND_RECON",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\&\\s*ping\\b|;\\s*ping\\b|\\|\\s*ping\\b|\\bping\\s+-[in]\\b|\\bnetstat\\s+-)",
    "use_aho": false,
    "message": "Ping/netstat usage attempts (possible recon/long-run command injection)",
    "severity": "medium",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "suspicious-vertical-bars-and-ids",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\|\\s*/usr/bin/id\\b|\\|\\s*id\\b|\"\\|/usr/bin/id\\|\"|'\\|/usr/bin/id\\|'|\\|id\\||\\|/usr/bin/id\\|)",
    "use_aho": false,
    "message": "Patterns containing pipes/vertical-bars around 'id' or '/usr/bin/id' (common in injected payloads)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "semicolon-id-variants",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:;\\s*id\\s*;|;id;|;\\s*/usr/bin/id\\s*;|\\b\\w+\\)\\s*;\\s*id\\b|\\b\\w+;\\s*/usr/bin/id\\b)",
    "use_aho": false,
    "message": "Semicolon-wrapped 'id' variants and common payload fragments (e.g. a);id )",
    "severity": "medium",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_shellshock",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\(\\)\\s*\\{\\s*:\\s*;\\s*\\}\\s*;?\\s*[-`\\w\\\"'\\s\\(\\)\\./:@%?=&+\\$\\\\]*?(?:\\b(?:curl|wget|sleep|uname|whoami|nc|/usr/bin/id|/bin/ls|/bin/cat|perl|bash|echo)\\b|`[^`]{1,400}`|\\$\\([^\\)]{1,400}\\))",
    "use_aho": false,
    "message": "Shellshock-style payload or immediate command substitution/download following '() { :; };' pattern",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_cmdsub_and_backticks",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:`[^`]{1,500}`|\\$\\(\\s*[^\\)]{1,500}\\s*\\)|\\$\\s*\\{\\s*[^\\}]{1,300}\\s*\\})\\s*(?:;|\\||&|\\)|\\{|\\[|\\s|$).*?(?:\\b(?:id|/usr/bin/id|whoami|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|perl\\b|phpinfo\\b|netstat\\b)\\b)",
    "use_aho": false,
    "message": "Command substitution / backticks / ${...} containing common commands (id, ls, cat, curl, wget, nc, phpinfo, ...)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_operators_percent_newline",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%0a|%0A|%0d|%0D|\\n|\\r|\\\\n|\\\\r)\\s*(?:/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|netstat\\b|phpinfo\\b|ping\\b)|(?:[\\|&;]{1,2}\\s*(?:/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|perl\\b|phpinfo\\b|netstat\\b|net\\s+user|net\\s+localgroup|reg\\s+add|ipconfig|ifconfig|dir\\b|type\\b))|(?:\\b[a-zA-Z0-9_]{0,12}[\\)\\]]?\\s*[;\\|]\\s*(?:id\\b|/usr/bin/id|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b))",
    "use_aho": false,
    "message": "Command chaining operators (|, ||, &, &&, ;) or encoded newlines followed by suspicious commands",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_php_eval_system_echo_write",
    "group_id": "CODE_EXECUTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\b(?:eval|exec|system|shell_exec|passthru|popen|pcntl_exec)\\s*\\(\\s*['\\\"][^'\\\"]{0,1000}(?:/etc/passwd|/etc/shadow|/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|curl\\b|wget\\b|nc\\b|phpinfo\\b|netstat\\b)[^'\\\"]*['\\\"]\\s*\\)|<\\?php[^>]{0,800}?(?:system|exec|shell_exec|passthru|phpinfo|`)[^>]*\\?>|\\becho\\b\\s*[\"']\\s*<\\?php[^\"']*\\?>\\s*[\"']\\s*>\\s*\\w+\\.php|\\{\\s*\\$?\\s*\\{\\s*(?:phpinfo|sleep)\\s*\\(\\s*\\d{1,4}\\s*\\)\\s*\\}\\s*\\}|\\{\\{\\s*get_user_file\\s*\\(|\\{\\{\\s*person\\.secret|\\{\\{\\s*person\\.name",
    "use_aho": false,
    "message": "Runtime eval/exec/system or PHP tags / echo write-to-file / template-injection (phpinfo/sleep/get_user_file etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_rev_shell_perl_windows_flood",
    "group_id": "DOS_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\b(?:curl|wget)\\b[^\\s]{0,600}https?://[\\w\\-\\.:@/\\?=&#%+~_\\[\\]\\$`'\"\\\\\\(\\)-]{10,}|\\bnc\\b\\s*(?:-l|-lvvp|\\-e)?\\s*\\d{2,5}\\s*(?:-e\\s*/bin/sh)?|\\bnc\\s+\\-e\\b|\\bperl\\b\\s*-e\\s*'print\\s+\"X\"x\\d{3,6}'|\\bperl\\b\\s*-e\\s*'print\\s+\"X\"x\\d{3,6}'|\\btype\\b\\s+C:\\\\Windows\\\\repair\\\\SAM|\\btype\\b\\s+C:\\\\boot.ini|\\bnet\\s+localgroup\\s+Administrators|\\bnet\\s+user\\b|\\breg\\s+add\\s+\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\"|\\bnetsh\\b\\s+firewall|\\bipconfig\\b\\s*/all|\\bdir\\s+C:\\\\Users|\\bwhoami\\b|\\bwhich\\s+(?:curl|gcc|nc|perl|python|wget)\\b)",
    "use_aho": false,
    "message": "Download/reverse-shell (curl/wget/nc), perl flood, Windows RCE/admin commands, reconnaissance commands (whoami/which/etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_double_slash_domain_bypass",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[\\/\\\\%]{2,}|(?:%2f|%5c|%09|%00){2,})\\s*[-\\w%\\.]{0,50}\\.(?:com|net|org|io|vn|xyz|example)\\b",
    "use_aho": false,
    "message": "URL bypass using repeated slashes/backslashes/encoded-slashes before domain (e.g. //example.com, /%2f%2fexample.com, \\\\example.com)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_encoded_or_malformed_scheme",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%68%74%74%70%3a%2f%2f|%68%74%74%70|https?:)(?:%3a|:)?(?:%2f|\\/){1,3}[-\\w%:\\.@\\/\\\\]+\\.(?:com|net|org|io|vn|xyz|example)\\b",
    "use_aho": false,
    "message": "Encoded or malformed HTTP(S) scheme used to hide external target (hex-encoded http://, http:/, https:/// etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_open_redirect_param_bypass",
    "group_id": "OPEN_REDIRECT",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)[\\?&](?:url|next|redirect|redir|rurl|redirect_uri)\\s*=\\s*(?:\\/+|(?:\\\\/)|(?:%2f)+|%5c+|https?:|\\/\\/)",
    "use_aho": false,
    "message": "Open-redirect parameter contains absolute/escaped/encoded external target (e.g. ?url=//example.com, ?redirect=/\\/example.com, ?url=Https://example.com)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_traversal_with_domain_or_encoded_dots",
    "group_id": "PATH_TRAVERSAL",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\.(?:\\.|%2e%2e)|%2e%2e|\\/\\.\\.|\\/(?:%2f|%2e|\\.){0,2}\\.{1,2})[^\\s]{0,80}\\.(?:com|net|org|io|vn|xyz|example)\\b|\\/(?:[\\w%\\-\\.\\/]*)(?:%2e%2e|\\.\\.|%2f%2e%2e)\\b",
    "use_aho": false,
    "message": "Path traversal or encoded '..' combined with domain/path (e.g. /example.com/%2e%2e, ////example.com/%2e%2e%2f)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_control_unicode_separator_bypass",
    "group_id": "URL_BYPASS_MISC",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%00|%09|%0a|%0d|%e3%80%82|\\<\\>|\\\\;@|\\;@|\\s\\/{2,}[^\\s]*\\;@|%5c;@)|(?:google%00|google%E3%80%82|\\<\\>\\/\\/[-\\w%\\.]+)",
    "use_aho": false,
    "message": "Control/unicode/null/tab or exotic separator bypass attempts (null/tab/unicode dots, \\;@, <> , etc.) used to hide external redirect/SSRF",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_leading_dot_domain",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^[.]([A-Za-z0-9-]+[.])*[A-Za-z]{2,}$",
    "use_aho": false,
    "message": "Leading-dot domain in path (e.g. /.example.com) — likely SSRF/redirect obfuscation",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_duplicate_param",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&])([A-Za-z0-9_\\-]+)=.*(?:[?&]\\1=){2,}",
    "use_aho": false,
    "message": "Duplicate HTTP parameter name detected (>=3 occurrences) — possible HPP",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_array_param_safe",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&])(tags|filter|item)\\[\\]=.*[?&]\\1\\[\\]=",
    "use_aho": false,
    "message": "Array-style parameter repeated — allowed for whitelisted params",
    "severity": "low",
    "action": "ignore",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_encoded_ampersand_value",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&][A-Za-z0-9_\\-]+=)[^\\r\\n]{0,200}(?:%26|%3B)(?:[A-Za-z0-9_\\-]+)=",
    "use_aho": false,
    "message": "Encoded ampersand or semicolon inside param value that may create extra params — possible HPP",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_null_byte_param",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%00|\\x00|\\u0000)",
    "use_aho": false,
    "message": "Null byte detected in query string or urlencoded body — possible HPP or injection attempt",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_semicolon_param",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)[?&][^=\\s]{1,80}=[^\\r\\n]{0,200};[^=\\s]{1,80}=[^\\r\\n]{0,200}",
    "use_aho": false,
    "message": "Semicolon used inside parameter values may inject additional key=value pairs — potential HPP",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_multiple_header",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^(?:[^\r\n]*\r?\n)*Host:\\s*[^\r\n]+(?:\r?\n)[^\r\n]*Host:\\s*[^\r\n]+",
    "use_aho": false,
    "message": "Multiple Host headers detected — possible header injection/request smuggling",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_crlf_null_injection",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^.*Host:\\s*[^\r\n]*?(%0d|%0a|\\x00|\\r|\\n).*$",
    "use_aho": false,
    "message": "Host header contains CRLF/null byte/percent-encoded newline — possible header injection/CRLF attack",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_path_or_userinfo",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^.*Host:\\s*(?!.*\\b(?:app\\.example\\.com|api\\.example\\.com|localhost|127\\.0\\.0\\.1)\\b)(.*[/@].*)$",
    "use_aho": false,
    "message": "Host header contains path component or '@' — possible host header manipulation",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_leading_dot_or_ip",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^.*Host:\\s*(?!.*\\b(?:app\\.example\\.com|api\\.example\\.com|localhost|127\\.0\\.0\\.1)\\b)(?:\\.|\\d+\\.\\d+\\.\\d+\\.\\d+:).*$",
    "use_aho": false,
    "message": "Host header starts with a leading dot or IP:port — suspicious",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_not_in_whitelist",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^.*Host:\\s*(?!.*\\b(?:app\\.example\\.com|api\\.example\\.com|localhost|127\\.0\\.0\\.1)\\b).*$",
    "use_aho": false,
    "message": "Host header not in whitelist — potential host header injection",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xml_non_xml_content_scan_safe",
    "group_id": "GENERAL",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(<\\?xml|<xsl:stylesheet|php:function\\()",
    "use_aho": false,
    "message": "XML or XSLT signature detected in request body (scan only for XML content types)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_doctype_external",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!DOCTYPE\\s+[^>]+\\s+(SYSTEM|PUBLIC)",
    "use_aho": false,
    "message": "XXE: External DOCTYPE declaration detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_param_entity_decl_limited",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(<!ENTITY\\s+%\\s*[A-Za-z0-9_\\-]+\\s+SYSTEM\\s+[\"'][^\"']+[\"'])",
    "use_aho": false,
    "message": "XXE: Parameter ENTITY (%name SYSTEM '...') declaration detected",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_uri_safe",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+[^>]+SYSTEM\\s+[\"']\\s*(file|http|https|php|data):\\/\\/[^\"']+[\"']",
    "use_aho": false,
    "message": "XXE: ENTITY SYSTEM references external URI — high-risk",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_many_entity_decls_threshold",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:<!ENTITY\\s+[^>]*>\\s*){4,}",
    "use_aho": false,
    "message": "XXE: Multiple ENTITY declarations — potential Billion Laughs attack",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_value_recursion_threshold",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+[A-Za-z0-9_\\-]+\\s+\"(?:&[A-Za-z0-9_\\-]+;){3,}\">",
    "use_aho": false,
    "message": "XXE: ENTITY recursively referencing others — exponential expansion vector",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xsl_document_function_safe",
    "group_id": "XSLT_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<xsl:stylesheet[^>]*>|<\\?xml-stylesheet|document\\s*\\(",
    "use_aho": false,
    "message": "XSLT stylesheet or document() function detected — possible file/remote inclusion",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xsl_php_function_call_safe",
    "group_id": "XSLT_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)php:function\\s*\\(",
    "use_aho": false,
    "message": "XSLT php:function() usage detected — potential RCE or data exfiltration",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xml_cdata_script_safe",
    "group_id": "XML_XSS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!\\[CDATA\\[.*?(<script|javascript:|onerror|onload).*?\\]\\]>",
    "use_aho": false,
    "message": "XML/CDATA block contains script — possible XSS injection (alert only on user-supplied XML)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  }
]